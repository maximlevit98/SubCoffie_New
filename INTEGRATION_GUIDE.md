# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üéâ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### Phase 1: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ ‚úÖ
- **Backend:** RPC —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤, –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞–∫–∞–∑–æ–≤
- **Admin Panel:** UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∑–∞–∫–∞–∑–æ–≤
- **iOS:** Real-time –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ —á–µ—Ä–µ–∑ Supabase Realtime

### Phase 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞–º–∏ ‚úÖ
- **Backend:** RPC —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±–∞–ª–∞–Ω—Å–æ–≤, –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **Admin Panel:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞–º–∏ —Å —Ä—É—á–Ω—ã–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ–º/—Å–ø–∏—Å–∞–Ω–∏–µ–º —Å—Ä–µ–¥—Å—Ç–≤
- **iOS:** –°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ WalletStore —Å –ë–î –∏ view –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### Phase 3: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã ‚úÖ
- **Backend:** –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ view –∏ RPC —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **Admin Panel:** Dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏, –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –≤—ã—Ä—É—á–∫–∏ –∏ —Ç–æ–ø–æ–º –ø–æ–∑–∏—Ü–∏–π

### Phase 4: Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚úÖ
- **Backend:** –¢–∞–±–ª–∏—Ü–∞ push_tokens, —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** –ì–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å APNs —á–µ—Ä–µ–∑ Edge Functions

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### Backend (SubscribeCoffieBackend)
```
supabase/migrations/
‚îú‚îÄ‚îÄ 20260131000000_order_management_rpc.sql      # RPC –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
‚îú‚îÄ‚îÄ 20260131010000_wallet_sync_functions.sql     # RPC –¥–ª—è –∫–æ—à–µ–ª—å–∫–æ–≤
‚îú‚îÄ‚îÄ 20260131020000_analytics_views.sql           # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îî‚îÄ‚îÄ 20260131030000_push_notifications.sql        # Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```

### Admin Panel (subscribecoffie-admin)
```
app/admin/
‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                                 # Dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
‚îú‚îÄ‚îÄ orders/
‚îÇ   ‚îú‚îÄ‚îÄ actions.ts                               # Server actions –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                                 # –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ OrdersTable.tsx                          # –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ [id]/
‚îÇ       ‚îú‚îÄ‚îÄ page.tsx                             # –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
‚îÇ       ‚îî‚îÄ‚îÄ OrderStatusButtons.tsx               # –ö–Ω–æ–ø–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
‚îú‚îÄ‚îÄ wallets/
‚îÇ   ‚îú‚îÄ‚îÄ actions.ts                               # Server actions –¥–ª—è –∫–æ—à–µ–ª—å–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                                 # –°–ø–∏—Å–æ–∫ –∫–æ—à–µ–ª—å–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ [userId]/
‚îÇ       ‚îú‚îÄ‚îÄ page.tsx                             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–æ–º
‚îÇ       ‚îî‚îÄ‚îÄ AddTransactionForm.tsx               # –§–æ—Ä–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
‚îî‚îÄ‚îÄ layout.tsx                                   # Layout —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

lib/supabase/queries/
‚îú‚îÄ‚îÄ orders.ts                                    # Queries –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
‚îú‚îÄ‚îÄ wallets.ts                                   # Queries –¥–ª—è –∫–æ—à–µ–ª—å–∫–æ–≤
‚îî‚îÄ‚îÄ analytics.ts                                 # Queries –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
```

### iOS (SubscribeCoffieClean)
```
Helpers/
‚îú‚îÄ‚îÄ RealtimeOrderService.swift                   # Real-time –∑–∞–∫–∞–∑—ã
‚îî‚îÄ‚îÄ WalletSyncService.swift                      # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ—à–µ–ª—å–∫–∞

Views/
‚îú‚îÄ‚îÄ ActiveOrdersView.swift                       # –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
‚îî‚îÄ‚îÄ WalletHistoryView.swift                      # –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
cd SubscribeCoffieBackend
supabase migration up
```

–≠—Ç–æ –ø—Ä–∏–º–µ–Ω–∏—Ç –≤—Å–µ 4 –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ—à–µ–ª—å–∫–æ–≤
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 2. –ó–∞–ø—É—Å–∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

```bash
cd subscribecoffie-admin

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
npm install

# –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞
npm run dev
```

–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3000`

–ù–∞–≤–∏–≥–∞—Ü–∏—è:
- `/admin/dashboard` - Dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- `/admin/orders` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
- `/admin/wallets` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞–º–∏
- `/admin/cafes` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ñ–µ
- `/admin/menu-items` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é

### 3. –ó–∞–ø—É—Å–∫ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd SubscribeCoffieClean
./run-simulator.sh
```

–ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Xcode:
```bash
open SubscribeCoffieClean/SubscribeCoffieClean.xcodeproj
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Admin Panel: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `/admin/orders`
2. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑ –∏–∑ —Å–ø–∏—Å–∫–∞
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω—É–∂–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "‚Üí preparing")
4. –ò–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤—è—Ç—Å—è –≤ –ë–î –∏ —Ç—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞—Å—Ç –∑–∞–ø–∏—Å—å –≤ `order_events`
5. iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∏—Ç real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Supabase

### Admin Panel: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–æ–º

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `/admin/wallets`
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –í—ã–±–µ—Ä–∏—Ç–µ "–ù–∞—á–∏—Å–ª–∏—Ç—å" –∏–ª–∏ "–°–ø–∏—Å–∞—Ç—å"
4. –£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É –∏ –ø—Ä–∏—á–∏–Ω—É
5. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∏—Å–ª–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞" / "–°–ø–∏—Å–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞"
6. –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Å iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### iOS: Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤

```swift
// –í ContentView –∏–ª–∏ –¥—Ä—É–≥–æ–º view
@StateObject private var realtimeService = RealtimeOrderService()

// –í .task –∏–ª–∏ onAppear
await realtimeService.subscribeToOrders(phone: userPhone)

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
ForEach(realtimeService.activeOrders) { order in
    OrderCard(order: order)
}
```

### iOS: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ—à–µ–ª—å–∫–∞

```swift
@StateObject private var walletSync = WalletSyncService()

// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
Task {
    try await walletSync.syncWallet(userId: userId)
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
Text("–ë–∞–ª–∞–Ω—Å: \(walletSync.balance) –∫—Ä.")
```

## üîç API Endpoints

### RPC Functions (–¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `/rest/v1/rpc/`)

#### –ó–∞–∫–∞–∑—ã
- `update_order_status(order_id, new_status, actor_user_id)` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `get_orders_by_cafe(cafe_id, status_filter, limit, offset)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
- `get_order_details(order_id)` - –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ —Å items –∏ –∏—Å—Ç–æ—Ä–∏–µ–π
- `get_orders_stats(cafe_id, from_date, to_date)` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### –ö–æ—à–µ–ª—å–∫–∏
- `get_user_wallet(user_id)` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ (—Å–æ–∑–¥–∞–µ—Ç –µ—Å–ª–∏ –Ω–µ—Ç)
- `add_wallet_transaction(user_id, amount, type, description)` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `sync_wallet_balance(wallet_id)` - –ü–µ—Ä–µ—Å—á–µ—Ç –±–∞–ª–∞–Ω—Å–∞
- `get_wallet_transactions(user_id, limit, offset)` - –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

#### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- `get_dashboard_metrics(cafe_id)` - –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è dashboard
- `get_cafe_stats(cafe_id, from_date, to_date)` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—Ñ–µ
- `get_top_menu_items(cafe_id, limit, from_date)` - –¢–æ–ø –ø–æ–∑–∏—Ü–∏–π
- `get_revenue_by_day(cafe_id, days)` - –í—ã—Ä—É—á–∫–∞ –ø–æ –¥–Ω—è–º

#### Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `register_push_token(device_token, platform, app_version, device_model)` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
- `deactivate_push_token(device_token)` - –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
- `get_user_push_tokens(user_id)` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Row Level Security (RLS)

–í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∑–∞—â–∏—â–µ–Ω—ã RLS –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏:

- **orders** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã
- **wallets** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –∫–æ—à–µ–ª–µ–∫
- **push_tokens** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
- **push_notifications_log** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### Admin –¥–æ—Å—Ç—É–ø

Admin —Ä–æ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ middleware:
```typescript
const { role } = await requireAdmin();
// Throws error if role !== 'admin'
```

## üìä Real-time –ø–æ–¥–ø–∏—Å–∫–∏

### –ó–∞–∫–∞–∑—ã (iOS)
```swift
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
channel = supabase.channel("orders:\(phone)")
await channel!.on(.postgresChanges(.update, schema: "public", table: "orders")) { message in
    // Handle update
}
```

### –ö–æ—à–µ–ª—å–∫–∏ (iOS)
```swift
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞
channel = supabase.channel("wallet:\(userId)")
await channel!.on(.postgresChanges(.update, schema: "public", table: "wallets")) { message in
    // Handle update
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Backend
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ RPC —Ñ—É–Ω–∫—Ü–∏–π
cd SubscribeCoffieBackend

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
curl -X POST "http://127.0.0.1:54321/rest/v1/rpc/get_orders_stats" \
  -H "apikey: YOUR_ANON_KEY" \
  -H "Content-Type: application/json" \
  -d '{}'

# Dashboard –º–µ—Ç—Ä–∏–∫–∏
curl -X POST "http://127.0.0.1:54321/rest/v1/rpc/get_dashboard_metrics" \
  -H "apikey: YOUR_ANON_KEY" \
  -H "Content-Type: application/json" \
  -d '{}'
```

### Admin Panel
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run dev`
2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ admin
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### iOS
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–º—É–ª—è—Ç–æ—Ä
2. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–∫–∞–∑
3. –í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ç—É—Å
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ iOS –ø–æ–ª—É—á–∏–ª real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

## üêõ Troubleshooting

### Real-time –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ iOS

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. Supabase –∑–∞–ø—É—â–µ–Ω: `supabase status`
2. URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ `Environment.swift`
3. Realtime –≤–∫–ª—é—á–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Supabase

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. `.env.local` —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏
2. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã: `supabase migration up`
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Ä–æ–ª—å 'admin' –≤ —Ç–∞–±–ª–∏—Ü–µ `profiles`

### –ö–æ—à–µ–ª–µ–∫ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. User ID –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. RPC —Ñ—É–Ω–∫—Ü–∏—è `get_user_wallet` –¥–æ—Å—Ç—É–ø–Ω–∞
3. –õ–æ–≥–∏ –≤ Xcode console –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
iOS App                Admin Panel
   ‚Üì                        ‚Üì
   ‚Üì                        ‚Üì
   ‚Üì    ‚Üê REST API ‚Üí        ‚Üì
   ‚Üì                        ‚Üì
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚Üì
      Supabase Backend
            ‚îú‚îÄ‚îÄ PostgreSQL (data)
            ‚îú‚îÄ‚îÄ Realtime (subscriptions)
            ‚îú‚îÄ‚îÄ RPC Functions (business logic)
            ‚îî‚îÄ‚îÄ Triggers (automation)
```

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **Edge Functions –¥–ª—è Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**: –°–æ–∑–¥–∞—Ç—å Edge Function –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ APNs
2. **QR-–∫–æ–¥ –¥–ª—è –≤—ã–¥–∞—á–∏ –∑–∞–∫–∞–∑–æ–≤**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR
3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏**: –î–æ–±–∞–≤–∏—Ç—å recharts –≤ –∞–¥–º–∏–Ω–∫—É –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
4. **–¢–µ–º–Ω–∞—è —Ç–µ–º–∞**: –î–æ–±–∞–≤–∏—Ç—å toggle —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã –≤ –∞–¥–º–∏–Ω–∫–µ
5. **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö**: –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤ –≤ CSV/Excel

## üí° Tips & Tricks

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Logger.shared.log()` –≤ iOS –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `logs/error.log` –≤ backend –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- Admin panel –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Server Actions - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–µ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: Xcode console / backend logs / browser console
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env.local` —Ñ–∞–π–ª—ã
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Supabase –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω

---

**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–î–∞—Ç–∞**: 31 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ñ–∞–∑—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
