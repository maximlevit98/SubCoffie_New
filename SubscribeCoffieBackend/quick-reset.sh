#!/bin/bash

# ============================================================================
# Quick Reset Script –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
# ============================================================================
# –ë—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç –ë–î —Å–æ –≤—Å–µ–º–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./quick-reset.sh
# ============================================================================

set -e

echo ""
echo "üîÑ ============================================"
echo "üîÑ –ë–´–°–¢–†–´–ô –°–ë–†–û–° –ë–ê–ó–´ –î–ê–ù–ù–´–•"
echo "üîÑ ============================================"
echo ""

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é backend
cd "$(dirname "$0")"

echo "üìä –°–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö..."
supabase db reset

echo ""
echo "‚úÖ ============================================"
echo "‚úÖ –ì–û–¢–û–í–û!"
echo "‚úÖ ============================================"
echo ""
echo "üìã –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:"
echo "   Email: levitm@algsoft.ru"
echo "   Password: 1234567890"
echo ""
echo "üåê –°—Å—ã–ª–∫–∏:"
echo "   - Admin Panel: http://localhost:3000"
echo "   - Supabase Studio: http://localhost:54323"
echo ""
echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:"

psql postgresql://postgres:postgres@127.0.0.1:54322/postgres -c "
SELECT 
  'üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π' as \"–¢–∏–ø\", 
  COUNT(*)::text as \"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ\"
FROM auth.users
UNION ALL
SELECT 'üè™ –ö–æ—Ñ–µ–µ–Ω', COUNT(*)::text FROM public.cafes
UNION ALL
SELECT 'üçΩÔ∏è –ü–æ–∑–∏—Ü–∏–π –º–µ–Ω—é', COUNT(*)::text FROM public.menu_items
UNION ALL
SELECT 'üì¶ –ó–∞–∫–∞–∑–æ–≤', COUNT(*)::text FROM public.orders_core;
"

echo ""
